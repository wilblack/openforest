{% load account_tags %}
{% load switchcase %}
{% load restructuredtext %}
{% load wakawaka_tags %}
{% load markup %}
{% load gravatar %}
{% load extra_tagging_tags %}

<div class="blog-post clearfix">
    <h2><a href="{{ blog_post.get_absolute_url }}">{{ blog_post.title }}</a></h2>
    
    <div class="blog-post-tease">
        {% if blog_post.tease %}
             {% with blog_post.tease|truncatewords:"25" as body %}

                  {{ body|safe }} 
                                            
            {% endwith %}
        {% else %}
            {% with blog_post.body|truncatewords:"25" as body %}
                {% if blog_post.markup %}
                    {% switch blog_post.markup %}
                        {% case 'rst' %} {{ body|safe }} {% endcase %}
                        {% case 'mrk' %} {{ body|safe }} {% endcase %}
                        {% case 'txl' %} {{ body|safe }} {% endcase %}
                    {% endswitch %}
                {% else %}
                    {{ body|safe }}
                {% endif %}
            {% endwith %}
        {% endif %}
    </div>
    
    
    <div class="blog-post-meta">
        {# gravatar blog_post.author 40 #}
        <p><b>Entered by:</b><br />
            <a href="{% url profile_detail blog_post.author.username %}">{% user_display blog_post.author %}</a> on {{ blog_post.publish|date }}</p>
        {% if blog_post.feature_of %}
        <p><b>Belongs to:</b><br />
            <a href="{{ blog_post.feature_of.get_absolute_url }}">{{blog_post.feature_of.title}}</a></p>
        {%endif%}
        <div class="blog-tags">
            <p>{% show_tags_for blog_post %}</p>
        </div>
    </div>
    <div class="clearfix"></div>
    
    <div>
      <div id="map_canvas" class="left"></div>
      <div id="featureList">
      	<ul>
      	{% for f in blog_post.feature_set.all %}
      	<li><a href="{{f.get_absolute_url}}">{{f.title|safe}}</a></li>
      	{%endfor%}
      	</ul>
      </div>
      <div class="clearFix"></div>
    </div>
    
    <div>
    	{{blog_post.body|safe}}
    </div>
	
	
</div>
